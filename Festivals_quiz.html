<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¯€æ…¶å–®å­—å¤§æŒ‘æˆ°</title>
    <style>
        :root { --p: #6c5ce7; --s: #00b894; --a: #fdcb6e; --bg: #f9f9fb; }
        body { font-family: 'Microsoft JhengHei', Arial, sans-serif; background: var(--bg); padding: 20px; color: #2d3436; }
        .container { max-width: 700px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: var(--p); }
        .section-header { 
            background: #f0edff; padding: 12px 20px; border-radius: 10px; 
            margin: 30px 0 15px; font-weight: bold; font-size: 1.25rem; 
            border-left: 8px solid var(--p); color: #4834d4;
        }
        .question-card { 
            background: #fff; border: 2px solid #f0f0f0; padding: 20px; 
            margin-bottom: 15px; border-radius: 15px;
        }
        .audio-btn { 
            background: var(--a); border: none; color: #634d00; padding: 10px 20px; 
            border-radius: 50px; cursor: pointer; font-weight: bold; margin-bottom: 10px;
        }
        .hint-display { 
            font-size: 1.4rem; text-align: center; margin: 15px 0; 
            padding: 15px; background: #fff9db; border-radius: 10px; color: #e67e22; font-weight: bold;
            border: 1px dashed #f39c12;
        }
        .options button { 
            display: block; width: 100%; text-align: left; margin: 8px 0; padding: 14px; 
            border: 2px solid #eee; border-radius: 12px; background: white; cursor: pointer; font-size: 1.1rem;
        }
        .options button:hover { background: #f5f3ff; border-color: var(--p); }
        .options button.selected { background: #efecff; border-color: var(--p); font-weight: bold; }
        .fill-container { display: flex; align-items: center; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .fill-input { 
            width: 35px; border: none; border-bottom: 3px solid var(--p); 
            font-size: 1.8rem; text-align: center; margin: 0 5px; background: #fffde7; outline: none;
        }
        #submit-btn { 
            width: 100%; padding: 20px; background: var(--s); color: white; 
            border: none; border-radius: 15px; font-size: 1.5rem; cursor: pointer; font-weight: bold; margin-top: 30px;
        }
        .feedback { font-weight: bold; margin-top: 10px; display: none; }
        #result-area { display: none; text-align: center; margin-top: 25px; padding: 25px; border-radius: 15px; background: #fff9db; border: 2px solid #ffd600; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ¡ ç¯€æ…¶è‹±æ–‡å–®å­—å¤§æŒ‘æˆ° ğŸ¡</h1>
    <div id="quiz-content">æ­£åœ¨ç‚ºå°è¶…äººæº–å‚™é¡Œç›®...</div>
    <button id="submit-btn" onclick="calculateScore()">äº¤å·ï¼Œçœ‹åˆ†æ•¸ï¼</button>
    <div id="result-area">
        <h2 id="score-text"></h2>
        <button onclick="location.reload()" style="padding:12px 24px; cursor:pointer; background:var(--p); color:white; border:none; border-radius:8px;">é‡æ–°æ¸¬é©—</button>
    </div>
</div>

<script>
    const wordBank = [
        { en: "Moon Festival", cn: "ä¸­ç§‹ç¯€", desc: "ã€å¤§å¤§çš„æœˆäº®ç…§è‘—ä¸€å®¶äººã€‘" },
        { en: "barbecue", cn: "çƒ¤è‚‰", desc: "ã€ç«çˆä¸Šé¢æ­£åœ¨çƒ¤é¦™è…¸ã€‘" },
        { en: "moon cake", cn: "æœˆé¤…", desc: "ã€åœ“åœ“çš„ï¼Œè£¡é¢æœ‰è›‹é»ƒçš„é»å¿ƒã€‘" },
        { en: "pomelo", cn: "æŸšå­", desc: "ã€ç¶ è‰²çš„çš®ï¼Œå¯ä»¥ç•¶å¸½å­æˆ´çš„æ°´æœã€‘" },
        { en: "Christmas", cn: "è–èª•ç¯€", desc: "ã€æ›æ»¿ç‡ˆæ³¡å’Œæ˜Ÿæ˜Ÿçš„æ¨¹ã€‘" },
        { en: "gift", cn: "ç¦®ç‰©", desc: "ã€ç”¨æ¼‚äº®ç·å¸¶ç¶å¥½çš„ç›’å­ã€‘" },
        { en: "Santa Claus", cn: "è–èª•è€äºº", desc: "ã€ç©¿ç´…è¡£æœã€ç™½é¬å­çš„è€å…¬å…¬ã€‘" },
        { en: "Halloween", cn: "è¬è–ç¯€", desc: "ã€å°æœ‹å‹ç©¿æ€ªç¸è¡£æœå»è¨ç³–æœã€‘" },
        { en: "jack-o-lantern", cn: "å—ç“œç‡ˆ", desc: "ã€æŒ–äº†çœ¼ç›å’Œå˜´å·´ï¼Œè£¡é¢æœ‰é»ç«çš„å—ç“œã€‘" },
        { en: "Easter", cn: "å¾©æ´»ç¯€", desc: "ã€æ‰¾å°‹å½©è‰²è›‹çš„ç¯€æ—¥ã€‘" },
        { en: "Easter Bunny", cn: "å¾©æ´»ç¯€å…”å­", desc: "ã€é•·è€³æœµã€æ‹¿è‘—ç±ƒå­é€å½©è›‹çš„å‹•ç‰©ã€‘" },
        { en: "Mother's Day", cn: "æ¯è¦ªç¯€", desc: "ã€å‘åª½åª½èªªè¬è¬çš„æ—¥å­ã€‘" },
        { en: "carnation", cn: "åº·ä¹ƒé¦¨", desc: "ã€é€çµ¦åª½åª½çš„ç²‰ç´…è‰²èŠ±æœµã€‘" },
        { en: "card", cn: "å¡ç‰‡", desc: "ã€å¯«æ»¿ç¥ç¦æ–‡å­—çš„å°æŠ˜ç´™ã€‘" },
        { en: "Dragon Boat Festival", cn: "ç«¯åˆç¯€", desc: "ã€å¤§å®¶åœ¨æ²³ä¸Šåˆ’é¾èˆŸçš„ç¯€æ—¥ã€‘" },
        { en: "rice dumpling", cn: "ç²½å­", desc: "ã€ç”¨è‘‰å­åŒ…èµ·ä¾†ï¼Œä¸‰è§’å½¢çš„ç±³é£¯ã€‘" },
        { en: "sachet", cn: "é¦™åŒ…", desc: "ã€æ›åœ¨è„–å­ä¸Šï¼Œé¦™é¦™çš„å°å¸ƒåŒ…ã€‘" }
    ];

    function speak(t) {
        const m = new SpeechSynthesisUtterance(t);
        m.lang = 'en-US';
        speechSynthesis.speak(m);
    }

    function startQuiz() {
        const container = document.getElementById('quiz-content');
        container.innerHTML = "";
        const shuffled = [...wordBank].sort(() => 0.5 - Math.random()).slice(0, 15);
        
        appendHeader(container, "ç¬¬ä¸€éƒ¨åˆ†ï¼šğŸ‘‚ è½éŸ³é¸æ„æ€ (5 é¡Œ)");
        for(let i=0; i<5; i++) renderChoice(container, shuffled[i], i, 'listening');

        appendHeader(container, "ç¬¬äºŒéƒ¨åˆ†ï¼šğŸ–¼ï¸ çœ‹æç¤ºé¸è‹±æ–‡ (5 é¡Œ)");
        for(let i=5; i<10; i++) renderChoice(container, shuffled[i], i, 'picture');

        appendHeader(container, "ç¬¬ä¸‰éƒ¨åˆ†ï¼šâœï¸ è½éŸ³æ‹¼æ‹¼çœ‹ (5 é¡Œ)");
        for(let i=10; i<15; i++) renderSpelling(container, shuffled[i], i);
    }

    function appendHeader(c, text) {
        const h = document.createElement('div');
        h.className = 'section-header';
        h.innerText = text;
        c.appendChild(h);
    }

    function renderChoice(c, item, idx, type) {
        const card = document.createElement('div');
        card.className = 'question-card';
        const isList = (type === 'listening');
        card.innerHTML = `
            <div><b>ç¬¬ ${idx+1} é¡Œ</b></div>
            ${isList ? `<button class="audio-btn" onclick="speak('${item.en}')">ğŸ”Š è½è½çœ‹é€™æ˜¯ä»€éº¼ç¯€æ—¥ï¼Ÿ</button>` : `<div class="hint-display">${item.desc}</div>`}
            <p>${isList ? 'é€™å–®å­—çš„æ„æ€æ˜¯ï¼Ÿ' : 'é€™å€‹æç¤ºå°æ‡‰å“ªå€‹è‹±æ–‡å–®å­—ï¼Ÿ'}</p>
            <div id="opts${idx}" class="options"></div>
            <p id="f${idx}" class="feedback"></p>
        `;
        card.setAttribute('data-ans', isList ? item.cn : item.en);
        c.appendChild(card);
        
        let opts = [isList ? item.cn : item.en];
        while(opts.length < 3) {
            let r = wordBank[Math.floor(Math.random()*wordBank.length)];
            let val = isList ? r.cn : r.en;
            if(!opts.includes(val)) opts.push(val);
        }
        opts.sort(() => 0.5 - Math.random()).forEach(o => {
            const b = document.createElement('button');
            b.innerText = o;
            b.onclick = function() {
                Array.from(b.parentElement.children).forEach(x => x.classList.remove('selected'));
                b.classList.add('selected');
                b.parentElement.setAttribute('data-sel', o);
            };
            document.getElementById('opts'+idx).appendChild(b);
        });
    }

    function renderSpelling(c, item, idx) {
        const card = document.createElement('div');
        card.className = 'question-card';
        let word = item.en;
        let html = '';
        
        for(let i=0; i<word.length; i++) {
            if(word[i] === ' ') {
                html += '<span style="margin: 0 10px;"> </span>'; // è™•ç†ç©ºæ ¼
            } else if (i === 0 || (i === word.length - 1 && word.length > 3)) {
                html += `<span>${word[i]}</span>`;
            } else {
                html += `<input type="text" class="fill-input q${idx}" data-idx="${i}" maxlength="1" oninput="if(this.value) focusNext(this, ${idx})">`;
            }
        }

        card.innerHTML = `
            <div><b>ç¬¬ ${idx+1} é¡Œ</b></div>
            <button class="audio-btn" onclick="speak('${item.en}')">ğŸ”Š è½ç™¼éŸ³ä¸¦æ‹¼å­—</button>
            <p>æç¤ºï¼š${item.cn}</p>
            <div class="fill-container">${html}</div>
            <p id="f${idx}" class="feedback"></p>
        `;
        card.setAttribute('data-word', item.en);
        c.appendChild(card);
    }

    function focusNext(el, qIdx) {
        const inputs = document.querySelectorAll('.q'+qIdx);
        for(let i=0; i<inputs.length; i++){
            if(inputs[i] === el && inputs[i+1]) {
                inputs[i+1].focus();
                break;
            }
        }
    }

    function calculateScore() {
        let s = 0;
        const cards = document.querySelectorAll('.question-card');
        cards.forEach((card, i) => {
            const f = document.getElementById('f'+i);
            f.style.display = "block";
            if(card.hasAttribute('data-word')) {
                const ans = card.getAttribute('data-word').toLowerCase();
                const inputs = card.querySelectorAll('.fill-input');
                let userArr = card.getAttribute('data-word').split('');
                inputs.forEach(inp => userArr[inp.getAttribute('data-idx')] = inp.value || '_');
                if(userArr.join('').toLowerCase() === ans) { s++; f.innerText = "âœ… å¤ªæ£’äº†ï¼"; f.style.color="green"; }
                else { f.innerText = "âŒ æ­£ç¢ºç­”æ¡ˆ: " + ans; f.style.color="red"; }
            } else {
                const optsDiv = card.querySelector('.options');
                const sel = optsDiv.getAttribute('data-sel');
                if(sel === card.getAttribute('data-ans')) { s++; f.innerText = "âœ… å¤ªæ£’äº†ï¼"; f.style.color="green"; }
                else { f.innerText = "âŒ æ­£ç¢ºç­”æ¡ˆ: " + card.getAttribute('data-ans'); f.style.color="red"; }
            }
        });
        document.getElementById('result-area').style.display = "block";
        document.getElementById('score-text').innerText = "æ¸¬é©—å®Œæˆï¼å¾—åˆ†ï¼š" + s + " / 15";
        window.scrollTo(0, document.body.scrollHeight);
    }

    window.addEventListener('load', startQuiz);
</script>
</body>
</html>